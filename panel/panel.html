<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grenne</title>
  <link rel="stylesheet" href="tailwind.generated.css" />
  <link rel="stylesheet" href="panel.css" />
</head>

<body>
  <main class="app" id="app" data-screen="onboarding">
    <header class="topbar">
      <button id="brandHomeBtn" class="brand brand--home-trigger" type="button" aria-label="Ir al chat principal">
        <div class="brand__emotion" id="brandEmotion" role="img" aria-label="Greene emotion neutral">
          <svg id="brandEmotionSvg" viewBox="0 0 67 47" fill="none" aria-hidden="true" focusable="false">
            <path id="brandEmotionEyeRight" class="brand__emotion-path"
              d="M41.9912 15.4673C44.7332 12.9205 48.206 11.8652 51.9638 12.0137C55.1073 12.1379 56.532 12.9681 58.4461 14.974C61.1728 17.8314 61.4988 21.7435 60.4406 25.3351C59.3616 28.9976 55.8663 30.2635 52.4625 31.7492C48.7168 33.3841 45.7722 33.4494 42.4898 31.7492C39.2347 30.0631 37.9407 28.3154 38.0021 24.3483C38.0554 20.902 39.4514 17.8263 41.9912 15.4673Z"
              fill="white" stroke="#3C3C4A" stroke-width="3"></path>
            <path id="brandEmotionEyeLeft" class="brand__emotion-path"
              d="M23.0609 15.5138C20.3114 12.9328 16.829 11.8634 13.0609 12.0139C9.90886 12.1397 8.48027 12.9811 6.56091 15.0139C3.82672 17.9096 3.49979 21.8741 4.5609 25.5139C5.6429 29.2253 9.14776 30.5082 12.5609 32.0139C16.3168 33.6707 19.2695 33.7369 22.5609 32.0139C25.8249 30.3052 27.1224 28.534 27.0609 24.5138C27.0074 21.0213 25.6076 17.9044 23.0609 15.5138Z"
              fill="white" stroke="#3C3C4A" stroke-width="3"></path>
          </svg>
        </div>
        <div>
          <p class="brand__eyebrow">assistant</p>
          <h1>Grenne</h1>
        </div>
      </button>
      <div class="topbar__actions">
        <button id="openSettingsBtn" class="icon-btn icon-btn--ghost" type="button" aria-label="Abrir settings" title="Settings">
          <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="512" height="512"><path fill="currentColor" d="M12,8a4,4,0,1,0,4,4A4,4,0,0,0,12,8Zm0,6a2,2,0,1,1,2-2A2,2,0,0,1,12,14Z"/><path fill="currentColor" d="M21.294,13.9l-.444-.256a9.1,9.1,0,0,0,0-3.29l.444-.256a3,3,0,1,0-3-5.2l-.445.257A8.977,8.977,0,0,0,15,3.513V3A3,3,0,0,0,9,3v.513A8.977,8.977,0,0,0,6.152,5.159L5.705,4.9a3,3,0,0,0-3,5.2l.444.256a9.1,9.1,0,0,0,0,3.29l-.444.256a3,3,0,1,0,3,5.2l.445-.257A8.977,8.977,0,0,0,9,20.487V21a3,3,0,0,0,6,0v-.513a8.977,8.977,0,0,0,2.848-1.646l.447.258a3,3,0,0,0,3-5.2Zm-2.548-3.776a7.048,7.048,0,0,1,0,3.75,1,1,0,0,0,.464,1.133l1.084.626a1,1,0,0,1-1,1.733l-1.086-.628a1,1,0,0,0-1.215.165,6.984,6.984,0,0,1-3.243,1.875,1,1,0,0,0-.751.969V21a1,1,0,0,1-2,0V19.748a1,1,0,0,0-.751-.969A6.984,6.984,0,0,1,7.006,16.9a1,1,0,0,0-1.215-.165l-1.084.627a1,1,0,1,1-1-1.732l1.084-.626a1,1,0,0,0,.464-1.133,7.048,7.048,0,0,1,0-3.75A1,1,0,0,0,4.79,8.992L3.706,8.366a1,1,0,0,1,1-1.733l1.086.628A1,1,0,0,0,7.006,7.1a6.984,6.984,0,0,1,3.243-1.875A1,1,0,0,0,11,4.252V3a1,1,0,0,1,2,0V4.252a1,1,0,0,0,.751.969A6.984,6.984,0,0,1,16.994,7.1a1,1,0,0,0,1.215.165l1.084-.627a1,1,0,1,1,1,1.732l-1.084.626A1,1,0,0,0,18.746,10.125Z"/></svg>
        </button>
        <button id="openToolsBtn" class="btn btn--ghost" type="button">Tools</button>
        <button id="chatResetBtn" class="icon-btn icon-btn--ghost" type="button" title="Reset history" aria-label="Reset history">
          <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="512" height="512"><path fill="currentColor"  d="M23.715,2.285a1.013,1.013,0,0,0-1.43,0L17.521,7.049l-.32-.313a5.008,5.008,0,0,0-6.429-.479A16.618,16.618,0,0,1,6.224,8.685L4.15,9.293a5.036,5.036,0,0,0-3.113,2.635A4.973,4.973,0,0,0,.9,15.947a12.95,12.95,0,0,0,12.112,8.064h.924a1.011,1.011,0,0,0,.578-.182A15.288,15.288,0,0,0,21.224,13.62a5.029,5.029,0,0,0-1.453-4.374l-.8-.784,4.747-4.747A1.013,1.013,0,0,0,23.715,2.285Zm-10.107,19.7h-.6A11.3,11.3,0,0,1,8.7,21.138l.011-.006a11.546,11.546,0,0,0,4.351-3.8l.518-.761a1.01,1.01,0,0,0-1.67-1.138l-.518.761A9.535,9.535,0,0,1,7.8,19.327l-1.251.63a10.757,10.757,0,0,1-2.583-2.57,11.625,11.625,0,0,0,4.377-2.664,1.011,1.011,0,0,0-1.414-1.446,9.617,9.617,0,0,1-3.98,2.32c-.061-.135-.127-.267-.182-.406a2.906,2.906,0,0,1,.085-2.381,3.023,3.023,0,0,1,1.864-1.578l2.073-.608a15.364,15.364,0,0,0,3.426-1.588l7.915,7.712A14.192,14.192,0,0,1,13.608,21.989Zm5.62-8.683a12.421,12.421,0,0,1-.309,1.387L11.948,7.9l0,0a3.011,3.011,0,0,1,1.755-.566,2.973,2.973,0,0,1,2.084.849l2.569,2.509A3.01,3.01,0,0,1,19.228,13.306Z"/></svg>
        </button>
      </div>
    </header>

    <section class="stage" aria-live="polite">
      <div class="stage__track" id="stageTrack" style="--stage-offset-x: 0px;">
        <section class="screen screen--onboarding" id="onboardingScreen" aria-label="Onboarding">
          <article class="onboarding-shell">
            <div class="onboarding-card">
              <div class="onboarding-emotion" id="onboardingEmotion" role="img" aria-label="Greene emotion neutral">
                <svg id="onboardingEmotionSvg" viewBox="0 0 67 47" fill="none" aria-hidden="true" focusable="false">
                  <path id="onboardingEmotionEyeRight" class="brand__emotion-path"
                    d="M41.9912 15.4673C44.7332 12.9205 48.206 11.8652 51.9638 12.0137C55.1073 12.1379 56.532 12.9681 58.4461 14.974C61.1728 17.8314 61.4988 21.7435 60.4406 25.3351C59.3616 28.9976 55.8663 30.2635 52.4625 31.7492C48.7168 33.3841 45.7722 33.4494 42.4898 31.7492C39.2347 30.0631 37.9407 28.3154 38.0021 24.3483C38.0554 20.902 39.4514 17.8263 41.9912 15.4673Z"
                    fill="white" stroke="#3C3C4A" stroke-width="3"></path>
                  <path id="onboardingEmotionEyeLeft" class="brand__emotion-path"
                    d="M23.0609 15.5138C20.3114 12.9328 16.829 11.8634 13.0609 12.0139C9.90886 12.1397 8.48027 12.9811 6.56091 15.0139C3.82672 17.9096 3.49979 21.8741 4.5609 25.5139C5.6429 29.2253 9.14776 30.5082 12.5609 32.0139C16.3168 33.6707 19.2695 33.7369 22.5609 32.0139C25.8249 30.3052 27.1224 28.534 27.0609 24.5138C27.0074 21.0213 25.6076 17.9044 23.0609 15.5138Z"
                    fill="white" stroke="#3C3C4A" stroke-width="3"></path>
                </svg>
              </div>
              <h2>Welcome</h2>
              <label class="field">
                <span>Tu nombre</span>
                <input id="onboardingNameInput" type="text" placeholder="Tu nombre" />
              </label>
              <button id="onboardingContinueBtn" class="btn" type="button">Continuar</button>
              <p id="onboardingStatus" class="status" role="status"></p>
            </div>
          </article>
        </section>

        <section class="screen screen--home" aria-label="Home Chat">
          <article class="chat-shell">
            <section class="chat-body" id="chatBody">
              <div class="chat-messages" id="chatMessages"></div>
            </section>

            <section class="ai-dynamic-context" id="aiDynamicContext">
              <article class="tool-card p-0 ai-dynamic-area" id="dynamicSuggestionsArea" hidden>
                <div id="dynamicSuggestionsList" class="ai-dynamic-scroll" role="list" aria-label="Dynamic suggestions"></div>
              </article>

             
              <article class="tool-card p-0 ai-dynamic-area" id="dynamicRelationsArea" hidden>
                <div id="dynamicRelationsList" class="ai-dynamic-scroll" role="list" aria-label="Dynamic relations"></div>
              </article>
            </section>
            <div id="dynamicUiToast" class="dynamic-ui-toast" role="status" aria-live="polite" hidden></div>

            <section id="dynamicRelationsDetailScreen" class="dynamic-relations-detail-screen" hidden
              aria-label="Detalle de relaciones dinamicas">
              <header class="dynamic-relations-detail-screen__head">
                <button id="dynamicRelationsDetailBackBtn" class="icon-btn icon-btn--ghost icon-btn--back" type="button"
                  aria-label="Volver a relaciones dinamicas" title="Volver">
                  <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path d="M15 6l-6 6 6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round"></path>
                  </svg>
                </button>
                <div class="dynamic-relations-detail-screen__head-main">
                  <h3 id="dynamicRelationsDetailTitle">Relacion</h3>
                  <p id="dynamicRelationsDetailMeta" class="tool-copy"></p>
                </div>
              </header>
              <div id="dynamicRelationsDetailBody" class="dynamic-relations-detail-screen__body"></div>
              <p id="dynamicRelationsDetailStatus" class="status" role="status"></p>
            </section>

            <footer class="chat-composer">
              <div class="chat-input-row flex flex-col">
                <label class="sr-only" for="chatInput">Mensaje</label>
                <textarea autofocus id="chatInput" rows="1" placeholder="Ask anything"></textarea>
                <div class="flex w-full justify-between items-center gap-12">
                  <div class="chat-toolbar">
                    <div class="tool-picker" id="chatToolPicker">
                      <button id="chatToolBtn" class="tool-picker__trigger" type="button" aria-haspopup="listbox" aria-expanded="false"
                        aria-label="Seleccionar chat tool">
                        <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24">
                          <path fill="white" d="m10.54,15.49c.596.595.596,1.561,0,2.157l-5.508,5.508c-1.188,1.188-3.138,1.15-4.278-.115-1.068-1.186-.901-3.043.227-4.171l5.39-5.39c.595-.595,1.561-.596,2.156,0l2.012,2.012Zm5.412-4.487c1.263.002,2.544.501,3.487,1.445.561.552,1.313.446,1.561.275,1.819-1.259,3.018-3.343,3.018-5.723,0-.413-.037-.817-.106-1.21-.136-.768-1.107-1.041-1.659-.49l-1.647,1.647c-1.146,1.146-2.653,1.322-3.665.494-1.164-.952-1.228-2.672-.191-3.709l1.965-1.965c.551-.552.281-1.526-.487-1.662-.393-.07-.797-.106-1.21-.106-2.943,0-5.455,1.818-6.489,4.391-.207.514-.086,1.105.306,1.496l5.117,5.116Zm2.073,2.859c-.761-.761-1.831-1.007-2.804-.761l-7.222-7.221v-1.881c0-.752-.402-1.448-1.054-1.824L3.539.211C2.921-.146,2.14-.043,1.635.462L.463,1.634C-.043,2.139-.146,2.921.211,3.539l1.965,3.407c.376.652,1.071,1.053,1.823,1.053h1.878l7.224,7.223c-.245.972,0,2.042.761,2.803l5.057,5.003c1.147,1.147,3.128,1.256,4.274.108,1.148-1.15,1.003-2.867-.001-4.162l-5.166-5.112Z"/>
                        </svg>
                        <span id="chatToolLabel">Chat</span>
                        <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                          <path d="M7 10l5 5 5-5" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
                            stroke-linejoin="round"></path>
                        </svg>
                      </button>

                      <div id="chatToolMenu" class="tool-picker__menu" role="listbox" aria-label="Chat tools" hidden>
                        <button type="button" class="tool-picker__option is-active" role="option" aria-selected="true" data-chat-tool="chat">
                          Chat
                        </button>
                        <button type="button" class="tool-picker__option" role="option" aria-selected="false" data-chat-tool="write_email">
                          Write an email
                        </button>
                      </div>
                    </div>
                    <div class="model-picker">
                      <label class="sr-only" for="chatModelSelect">Modelo</label>
                      <select id="chatModelSelect" class="model-picker__select" aria-label="Seleccionar modelo"></select>
                      
                    </div>
                  </div>
                  <button id="chatSendBtn" class="icon-btn icon-btn--send" type="button" aria-label="Enviar mensaje">
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M12 20V6" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"></path>
                      <path d="M6 12l6-6 6 6" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                    </svg>
                  </button>
                </div>
              </div>
              
              <div class="flex justify-between px-3 text-gray-300">
                <p id="chatStatus" class="status" role="status"></p>
                <small>v1.0.0</small>
              </div>

            </footer>
          </article>
        </section>

        <section class="screen screen--tools" id="toolsScreen" data-tool="image" style="--tool-index: 0; --tool-count: 2"
          aria-label="Tools">
          <article class="tools-shell">
            <header class="tools-head">
              <button id="goHomeBtn" class="icon-btn icon-btn--ghost icon-btn--back" type="button" aria-label="Volver al chat" title="Volver">
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M15 6l-6 6 6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round"></path>
                </svg>
              </button>
              <h2>Tools</h2>
            </header>

            <section class="tools-body">
              <nav class="tool-tabs" aria-label="Tool selector">
                <button type="button" class="tool-tab is-active" data-tool-target="image">Image WebP</button>
                <button type="button" class="tool-tab" data-tool-target="retool">Retool</button>
              </nav>

              <div class="tool-viewport">
                <div class="tool-track" id="toolTrack">
                  <section class="tool-pane" data-tool-pane="image">
                    <article class="tool-card">
                      <h3>Image to WebP</h3>

                      <div id="imageDropzone" class="image-dropzone" role="button" tabindex="0" aria-label="Agregar imagenes">
                        <input id="imageInput" class="sr-only" type="file" multiple
                          accept="image/png,image/jpg,image/jpeg,image/gif,image/bmp" />
                        <p>Arrastra hasta 10 imagenes aqui o en cualquier parte de la pantalla.</p>
                        <button id="imagePickBtn" class="btn btn--ghost" type="button">Agregar imagenes</button>
                      </div>

                      <section class="quality-control" aria-label="Calidad de compresion WebP">
                        <div class="quality-control__head">
                          <span class="quality-control__label">Calidad WebP</span>
                          <strong id="imageQualityValue" class="quality-control__value">0.90</strong>
                        </div>
                        <input id="imageQuality" class="quality-slider" type="range" min="0.1" max="1" step="0.05" value="0.9" />
                      </section>

                      <div class="actions">
                        <button id="imageClearBtn" class="btn btn--ghost" type="button">Limpiar</button>
                      </div>

                      <ul id="imageQueueList" class="image-queue" aria-live="polite"></ul>

                      <p id="imageStatus" class="status" role="status"></p>
                    </article>
                  </section>

                  <section class="tool-pane" data-tool-pane="retool">
                    <article class="tool-card">
                      <h3>Retool Layout Cleanup</h3>
                      <p class="tool-copy">Esta tool se aplica sobre paginas de Retool (`https://*.retool.com/apps/*`).</p>

                      <label class="switch-line">
                        <span>Tool activa</span>
                        <span class="switch">
                          <input id="retoolToggle" type="checkbox" aria-label="Activar Retool Layout Cleanup" />
                          <span class="slider"></span>
                        </span>
                      </label>

                      <button id="applyRetoolBtn" class="btn" type="button">Aplicar ahora en pestana activa</button>
                      <p id="retoolStatus" class="status" role="status"></p>
                    </article>
                  </section>
                </div>
              </div>
            </section>
          </article>
        </section>

        <section class="screen screen--settings" id="settingsScreen" aria-label="Settings">
          <article class="settings-shell" id="settingsShell" data-settings-page="home">
            <header class="tools-head">
              <button id="closeSettingsBtn" class="icon-btn icon-btn--ghost icon-btn--back" type="button"
                aria-label="Volver al chat" title="Volver">
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M15 6l-6 6 6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round"></path>
                </svg>
              </button>
              <h2>Settings</h2>
              <button id="settingsSectionBackBtn" class="icon-btn icon-btn--ghost icon-btn--back" type="button"
                aria-label="Volver al home de settings" title="Volver a settings home" hidden>
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M15 6l-6 6 6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round"></path>
                </svg>
              </button>
            </header>

            <section class="settings-body">
              <article class="tool-card settings-card settings-page is-active" data-settings-page="home">
                <div class="settings-card__head">
                  <h3>Settings Home</h3>
                </div>
                <nav class="settings-nav-list" aria-label="Secciones de settings">
                  <button type="button" class="settings-nav-item" data-settings-target="user">
                    <span>User</span>
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  <button type="button" class="settings-nav-item" data-settings-target="assistant">
                    <span>Assistant</span>
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  <button type="button" class="settings-nav-item" data-settings-target="ai_models">
                    <span>AI Models</span>
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  <button type="button" class="settings-nav-item" data-settings-target="crm_erp_database">
                    <span>CRM/ERP Database</span>
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  <button type="button" class="settings-nav-item" data-settings-target="tabs">
                    <span>Tabs</span>
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                    </svg>
                  </button>
                  <button type="button" class="settings-nav-item" data-settings-target="system_variables">
                    <span>System Variables</span>
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M9 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                        stroke-linejoin="round"></path>
                    </svg>
                  </button>
                </nav>
              </article>

              <article class="tool-card settings-card settings-page" data-settings-page="user">
                <div class="settings-card__head">
                  <h3>User settings</h3>
                </div>

                <label class="field">
                  <span>Tu nombre</span>
                  <input id="settingsNameInput" type="text" placeholder="Tu nombre" />
                </label>

                <label class="field">
                  <span>Birthday</span>
                  <input id="settingsBirthdayInput" type="date" />
                </label>

                <label class="field">
                  <span>Apariencia</span>
                  <select id="settingsThemeModeSelect">
                    <option value="system">Sistema</option>
                    <option value="dark">Oscuro</option>
                    <option value="light">Claro</option>
                  </select>
                </label>

                <div class="actions">
                  <button id="settingsUserSaveBtn" class="btn" type="button">Guardar</button>
                </div>
                <p id="settingsUserStatus" class="status" role="status"></p>
              </article>

              <article class="tool-card settings-card settings-page" data-settings-page="assistant">
                <div class="settings-card__head">
                  <h3>Assistant</h3>
                </div>

                <label class="field">
                  <span>Language</span>
                  <select id="settingsLanguageSelect">
                    <option value="es">Español</option>
                    <option value="en">English</option>
                    <option value="pt">Português</option>
                    <option value="fr">Français</option>
                  </select>
                </label>

                <label class="field">
                  <span>System prompt</span>
                  <textarea id="settingsSystemPrompt" rows="7"></textarea>
                </label>

                <div class="actions">
                  <button id="settingsAssistantSaveBtn" class="btn" type="button">Guardar</button>
                </div>
                <p id="settingsAssistantStatus" class="status" role="status"></p>
              </article>

              <article class="tool-card settings-card settings-page" data-settings-page="ai_models">
                <div class="settings-card__head settings-card__head--row">
                  <div>
                    <h3>AI Models</h3>
                  </div>
                  <button id="settingsAddModelBtn" class="icon-btn icon-btn--ghost" type="button"
                    aria-label="Agregar modelo" title="Agregar modelo">
                    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                      <path d="M12 5v14" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"></path>
                      <path d="M5 12h14" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"></path>
                    </svg>
                  </button>
                </div>

                <section id="aiModelsAccessWall" class="ai-models-wall" hidden>
                  <h4>Acceso protegido</h4>
                  <p id="aiModelsAccessCopy" class="tool-copy"></p>
                  <div class="actions">
                    <button id="aiModelsAccessActionBtn" class="btn" type="button"></button>
                  </div>
                </section>

                <div id="aiModelsProtectedContent" class="ai-models-content">
                  <label class="field">
                    <span>Modelo principal global</span>
                    <select id="aiPrimaryModelSelect"></select>
                  </label>

                  <div class="actions">
                    <button id="settingsRefreshLocalModelsBtn" class="btn btn--ghost" type="button">Actualizar modelos locales</button>
                  </div>

                  <ul id="aiModelsList" class="ai-models-list" aria-live="polite"></ul>

                  <section class="settings-security">
                    <div class="settings-card__head">
                      <h3>Seguridad API keys</h3>
                      <p id="settingsPinStatus" class="tool-copy"></p>
                    </div>
                    <div class="actions">
                      <button id="settingsSetupPinBtn" class="btn btn--ghost" type="button">Configurar PIN</button>
                      <button id="settingsUnlockPinBtn" class="btn btn--ghost" type="button">Desbloquear</button>
                      <button id="settingsLockPinBtn" class="btn btn--ghost" type="button">Bloquear</button>
                    </div>
                  </section>
                </div>

                <p id="aiModelsStatus" class="status" role="status"></p>
              </article>

              <article class="tool-card settings-card settings-page" data-settings-page="crm_erp_database">
                <div class="settings-card__head">
                  <h3>CRM/ERP Database</h3>
                  <p class="tool-copy">Configura una URL PostgreSQL para habilitar tools `db.*` en el chat.</p>
                </div>

                <label class="field">
                  <span>PostgreSQL URL</span>
                  <input id="settingsCrmErpDbUrlInput" type="password"
                    placeholder="postgresql://user:password@host/db?sslmode=require" autocomplete="off" />
                </label>

                <div class="actions actions--tight">
                  <button id="settingsCrmErpDbSaveBtn" class="btn btn--ghost" type="button">Guardar URL</button>
                  <button id="settingsCrmErpDbAnalyzeBtn" class="btn" type="button">Analizar esquema</button>
                </div>

                <p id="settingsCrmErpDbStatus" class="status" role="status"></p>
                <pre id="settingsCrmErpDbSchemaSummary" class="tabs-context-json"></pre>
              </article>

              <article class="tool-card settings-card settings-page" data-settings-page="tabs">
                <div class="settings-card__head">
                  <h3>Tabs context</h3>
                  <p class="tool-copy">JSON vivo de tabs abiertas con title, description, extracto y aiSummary usando el modelo principal.</p>
                </div>
                <pre id="tabsContextJson" class="tabs-context-json"></pre>
              </article>

              <article class="tool-card settings-card settings-page" data-settings-page="system_variables">
                <div class="settings-card__head">
                  <h3>System Variables</h3>
                  <p class="tool-copy">Variables editables agrupadas por area, incluyendo prompts.</p>
                </div>
                <div class="actions actions--tight">
                  <button id="systemVariablesSaveBtn" class="btn" type="button">Guardar cambios</button>
                  <button id="systemVariablesResetBtn" class="btn btn--ghost" type="button">Restaurar defaults</button>
                </div>
                <p id="systemVariablesStatus" class="status" role="status"></p>
                <div id="systemVariablesList" class="system-vars-list" aria-live="polite"></div>
              </article>
            </section>
          </article>
        </section>
      </div>
    </section>

    <div id="modelConfigModal" class="modal-backdrop" hidden>
      <section class="modal-card" role="dialog" aria-modal="true" aria-labelledby="modelConfigTitle">
        <header class="modal-card__head">
          <h3 id="modelConfigTitle">Agregar modelo</h3>
          <button id="modelConfigCloseBtn" class="icon-btn icon-btn--ghost icon-btn--mini" type="button" aria-label="Cerrar modal">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M18 6L6 18M6 6l12 12" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                stroke-linejoin="round"></path>
            </svg>
          </button>
        </header>

        <label class="field">
          <span>Empresa / Provider</span>
          <select id="modelProviderSelect">
            <option value="openai">OpenAI</option>
            <option value="anthropic">Anthropic</option>
            <option value="gemini">Gemini</option>
            <option value="openai_compatible">OpenAI Compatible (Third-party)</option>
            <option value="ollama">Ollama (local)</option>
          </select>
        </label>

        <label class="field">
          <span>Nombre visible</span>
          <input id="modelDisplayNameInput" type="text" placeholder="Ej. OpenAI producción" />
        </label>

        <label class="field">
          <span>Model ID</span>
          <input id="modelIdInput" type="text" placeholder="Ej. gpt-4o-mini" />
        </label>

        <label id="modelBaseUrlField" class="field" hidden>
          <span>Base URL (OpenAI compatible)</span>
          <input id="modelBaseUrlInput" type="url" placeholder="https://api.tu-provider.com/v1" />
        </label>

        <label id="modelApiKeyField" class="field">
          <span>API key</span>
          <input id="modelApiKeyInput" type="password" placeholder="Pega tu API key" autocomplete="off" />
        </label>

        <div class="actions">
          <button id="modelConfigSaveBtn" class="btn" type="button">Guardar</button>
          <button id="modelConfigCancelBtn" class="btn btn--ghost" type="button">Cancelar</button>
          <button id="modelConfigClearKeyBtn" class="btn btn--ghost" type="button" hidden>Eliminar API key</button>
        </div>
        <p id="modelConfigStatus" class="status" role="status"></p>
      </section>
    </div>

    <div id="pinModal" class="modal-backdrop" hidden>
      <section class="modal-card" role="dialog" aria-modal="true" aria-labelledby="pinModalTitle">
        <header class="modal-card__head">
          <h3 id="pinModalTitle">Configurar PIN</h3>
          <button id="pinModalCloseBtn" class="icon-btn icon-btn--ghost icon-btn--mini" type="button" aria-label="Cerrar modal">
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M18 6L6 18M6 6l12 12" fill="none" stroke="currentColor" stroke-width="1.9" stroke-linecap="round"
                stroke-linejoin="round"></path>
            </svg>
          </button>
        </header>

        <p id="pinModalCopy" class="tool-copy">El PIN se usa para cifrar API keys sensibles en IndexedDB.</p>

        <label class="field">
          <span>PIN de 4 digitos</span>
          <input id="pinInput" type="hidden" autocomplete="off" />
          <div class="pin-code-inputs" data-pin-group="pin">
            <input class="pin-digit-input" data-pin-target="pin" data-pin-index="0" type="password" inputmode="numeric" maxlength="1"
              pattern="[0-9]" aria-label="Digito 1 del PIN" autocomplete="one-time-code" autofocus />
            <input class="pin-digit-input" data-pin-target="pin" data-pin-index="1" type="password" inputmode="numeric" maxlength="1"
              pattern="[0-9]" aria-label="Digito 2 del PIN" autocomplete="one-time-code" />
            <input class="pin-digit-input" data-pin-target="pin" data-pin-index="2" type="password" inputmode="numeric" maxlength="1"
              pattern="[0-9]" aria-label="Digito 3 del PIN" autocomplete="one-time-code" />
            <input class="pin-digit-input" data-pin-target="pin" data-pin-index="3" type="password" inputmode="numeric" maxlength="1"
              pattern="[0-9]" aria-label="Digito 4 del PIN" autocomplete="one-time-code" />
          </div>
        </label>

        <label id="pinConfirmField" class="field">
          <span>Confirmar PIN</span>
          <input id="pinConfirmInput" type="hidden" autocomplete="off" />
          <div class="pin-code-inputs" data-pin-group="confirm">
            <input class="pin-digit-input" data-pin-target="confirm" data-pin-index="0" type="password" inputmode="numeric"
              maxlength="1" pattern="[0-9]" aria-label="Digito 1 de confirmacion" autocomplete="off" />
            <input class="pin-digit-input" data-pin-target="confirm" data-pin-index="1" type="password" inputmode="numeric"
              maxlength="1" pattern="[0-9]" aria-label="Digito 2 de confirmacion" autocomplete="off" />
            <input class="pin-digit-input" data-pin-target="confirm" data-pin-index="2" type="password" inputmode="numeric"
              maxlength="1" pattern="[0-9]" aria-label="Digito 3 de confirmacion" autocomplete="off" />
            <input class="pin-digit-input" data-pin-target="confirm" data-pin-index="3" type="password" inputmode="numeric"
              maxlength="1" pattern="[0-9]" aria-label="Digito 4 de confirmacion" autocomplete="off" />
          </div>
        </label>

        <div class="actions">
          <button id="pinModalSaveBtn" class="btn" type="button">Guardar PIN</button>
          <button id="pinModalCancelBtn" class="btn btn--ghost" type="button">Cancelar</button>
        </div>
        <p id="pinModalStatus" class="status" role="status"></p>
      </section>
    </div>

    <div id="dropOverlay" class="drop-overlay">Suelta archivos para convertir a WebP</div>
  </main>

  <script src="../src/tool-config.js"></script>
  <script type="module" src="panel.js"></script>
</body>

</html>
